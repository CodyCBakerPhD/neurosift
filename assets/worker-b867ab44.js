(function(){"use strict";let f,p,i;onmessage=function(n){n.data.canvas&&(f=n.data.canvas,b()),n.data.opts&&(p=n.data.opts,b()),n.data.beData&&(i=n.data.beData,b())};function P(n,o){let a=!1;return()=>{a||(a=!0,setTimeout(()=>{a=!1,n()},o))}}const v=["#ececec","#dfdfdf"],D=["#000","#00f","#0f0","#f00","#ff0","#f0f","#0ff","#800","#080","#008","#880","#808","#088"];let N=0;async function j(){if(!f||!p||!i)return;const n=++N,{margins:o,canvasWidth:a,canvasHeight:w,visibleStartTimeSec:c,visibleEndTimeSec:g}=p;f.width=a,f.height=w;const e=f.getContext("2d");if(!e)return;const k=i.seriesNames.length,m=(t,d)=>{if(c===void 0)return{x:0,y:0};if(g===void 0)return{x:0,y:0};const r=o.left+(t-c)/(g-c)*(a-o.left-o.right),l=o.top+(d+.5)*(w-o.top-o.bottom)/(k||1);return{x:r,y:l}};e.clearRect(0,0,a,w);for(let t=0;t<i.seriesNames.length;t++){const d=v[t%v.length];e.fillStyle=d;const r=m(c,t-.5),l=m(g,t+.5);e.fillRect(0,r.y,a,l.y-r.y);const h=i.seriesNames[t],x=m(c,t);e.fillStyle="black",e.font="12px sans-serif",e.textAlign="right",e.textBaseline="middle",e.fillText(h,x.x-10,x.y)}let S=Date.now();for(let t=0;t<i.seriesNames.length;t++){const d=i.seriesNames[t],r=i.series[d];if(!r)continue;const{categories:l,timestamps:h,data:x}=r,T={};for(let s=0;s<l.length;s++){const u=l[s]+"";T[u]=D[s%D.length]}e.font="12px sans-serif",e.textAlign="left",e.textBaseline="middle";for(let s=0;s<h.length;s++){const u=h[s],C=x[s];if(u<c||u>g)continue;const y=m(u,t);e.fillStyle=T[C+""]||"black",e.beginPath(),e.arc(y.x,y.y,3,0,2*Math.PI),e.fill(),e.fillText(C,y.x+5,y.y+1)}if(Date.now()-S>200){if(await new Promise(s=>setTimeout(s,10)),n!==N)return;S=Date.now()}}}const b=P(j,10)})();
